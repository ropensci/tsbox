<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tsbox â€¢ tsbox</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tsbox">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46240882-5', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tsbox</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/tsbox.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ts-functions.html">User Defined ts-Functions</a>
    </li>
    <li>
      <a href="../articles/convert.html">Time Conversion and Reguarization</a>
    </li>
    <li>
      <a href="../articles/class-struggle.html">Extending tsbox</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/christophsax/tsbox">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to tsbox</h1>
            <h3 class="subtitle">Class-Agnostic Time Series</h3>
                        <h4 class="author">Christoph Sax</h4>
            
          </div>

    
    
<div class="contents">
<p>The R ecosystem knows a <a href="https://cran.r-project.org/web/views/TimeSeries.html">vast number</a> of time series standards. Instead of creating the ultimate <a href="https://xkcd.com/927/">15th</a> time series class, tsbox provides a set of tools that are <strong>agnostic towards the existing standards</strong>. The tools also allow you to handle time series as plain data frames, thus making it easy to deal with time series in a <a href="https://CRAN.R-project.org/package=dplyr">dplyr</a> or <a href="https://CRAN.R-project.org/package=data.table">data.table</a> workflow.</p>
<p>tsbox is built around a set of converters, which convert time series stored as <strong>ts</strong>, <strong>xts</strong>, <strong>data.frame</strong>, <strong>data.table</strong> or <strong>tibble</strong> to each other. Because this works reliably and without user input, we can easily write functions that work for all classes. So whether we want to smooth, scale, differentiate, chain, forecast, regularize or seasonally adjust a time series, we can use the same commands to whatever time series class at hand. And, most conveniently, we get a time series plot function that works for all classes and frequencies.</p>
<p>To install:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">remotes<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"christophsax/tsbox"</span>)</code></pre></div>
<div id="convert-everything-to-everything" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-everything-to-everything" class="anchor"></a>Convert everything to everything</h2>
<p>tsbox can convert time series stored as <strong>ts</strong>, <strong>xts</strong>, <strong>data.frame</strong>, <strong>data.table</strong> or <strong>tibble</strong> to each other:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tsbox)
x.ts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(mdeaths, fdeaths)
x.xts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_xts</a></span>(x.ts)
x.df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_df</a></span>(x.xts)
x.tbl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_tbl</a></span>(x.df)
x.dt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_dt</a></span>(x.tbl)</code></pre></div>
</div>
<div id="use-same-functions-for-ts-xts-data-frame-data-table-or-tibble" class="section level2">
<h2 class="hasAnchor">
<a href="#use-same-functions-for-ts-xts-data-frame-data-table-or-tibble" class="anchor"></a>Use same functions for ts, xts, data.frame, data.table or tibble</h2>
<p>tsbox provides a basic toolkit for handling time series. These functions start with <code>ts_</code>, so you use them with auto complete (press Tab). These functions work with any <em>ts-boxable</em> time series, ts, xts, data.frame, data.table or tibble, and <strong>return the class of their inputs</strong>.</p>
<p>For example, the <code>ts_scale</code> function performs <em>normalization</em> - it subtracts the mean and divides by the standard deviation of series. Like almost all ts- functions, it can be used with on any ts-boxable object, with single or multiple time series. Because <code>ts_scale</code> normalizes time series, it is useful to make different time series comparable. All of the following operations perform the same task, but return the same object class as the input:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(x.ts)           
<span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(x.xts)
<span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(x.df)
<span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(x.dt)
<span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(x.tbl)</code></pre></div>
<p>There is a bunch of other transformation functions: <code>ts_trend</code>, which estimates a trend; functions to calculate differences, <code>ts_pc</code>, <code>ts_pcy</code>, <code>ts_diff</code>, <code>ts_diffy</code>; a function to shift series, <code>ts_lag</code>; functions to construct indices, both from levels and percentage change rates: <code>ts_index</code> and <code>ts_compound</code>. For a full list of functions, check out the reference.</p>
</div>
<div id="combine-multiple-time-series" class="section level2">
<h2 class="hasAnchor">
<a href="#combine-multiple-time-series" class="anchor"></a>Combine multiple time series</h2>
<p>A set of helper functions makes it easy to combine multiple time series, even if their classes are different. The basic workhorse is <code>ts_c</code>, which simply collect time series. Again, this works with single or multiple series of any ts-boxable class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(<span class="kw"><a href="../reference/ts_ts.html">ts_dt</a></span>(EuStockMarkets), AirPassengers)
<span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(<span class="kw"><a href="../reference/ts_ts.html">ts_tbl</a></span>(mdeaths), EuStockMarkets, <span class="kw"><a href="../reference/ts_ts.html">ts_xts</a></span>(lynx))</code></pre></div>
<p>If you want to choose a different name for single series, name the arguments:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(<span class="kw"><a href="../reference/ts_ts.html">ts_dt</a></span>(EuStockMarkets), <span class="st">`</span><span class="dt">Airline Passengers</span><span class="st">`</span> =<span class="st"> </span>AirPassengers)</code></pre></div>
<p>Multiple series can be also combined to a single series:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts_bind</span>(<span class="kw"><a href="../reference/ts_ts.html">ts_xts</a></span>(mdeaths), AirPassengers)</code></pre></div>
<p><code>ts_chain</code> offers an alternative way to combine time series, by <em>chain-linking</em> them. The following prolongs a short time series with percentage change rates of a longer one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">md.short &lt;-<span class="st"> </span><span class="kw">ts_window</span>(mdeaths, <span class="dt">end =</span> <span class="st">"1976-12-01"</span>)
<span class="kw"><a href="../reference/ts_bind.html">ts_chain</a></span>(md.short, fdeaths)</code></pre></div>
</div>
<div id="frequency-conversion-and-alignment" class="section level2">
<h2 class="hasAnchor">
<a href="#frequency-conversion-and-alignment" class="anchor"></a>Frequency conversion and alignment</h2>
<p>There are functions to convert the frequency of time series and to regularize irregular time series. The following changes the frequency of two series to annual:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_frequency.html">ts_frequency</a></span>(<span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(AirPassengers, austres), <span class="st">"year"</span>, sum)</code></pre></div>
<p>We already met <code>ts_window</code>, which can be used to limit the time span of a series. <code>ts_regular</code> makes irregular time series regular, by turning implicit missing values into explicit <code>NA</code>s.</p>
</div>
<div id="and-plot-just-about-everything" class="section level2">
<h2 class="hasAnchor">
<a href="#and-plot-just-about-everything" class="anchor"></a>And plot just about everything</h2>
<p>Of course, this works for plotting, too. The basic function is <code>ts_plot</code>, which can be used with any ts-boxable time series, single or multiple, of any frequency:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_plot.html">ts_plot</a></span>(AirPassengers, <span class="kw"><a href="../reference/ts_ts.html">ts_df</a></span>(lynx), <span class="kw"><a href="../reference/ts_ts.html">ts_xts</a></span>(fdeaths))</code></pre></div>
<p>If you want to use different names than the object names, just name the arguments (and optionally set a title):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ts_plot.html">ts_plot</a></span>(
  <span class="st">`</span><span class="dt">Airline Passengers</span><span class="st">`</span> =<span class="st"> </span>AirPassengers, 
  <span class="st">`</span><span class="dt">Lynx trappings</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_df</a></span>(lynx), 
  <span class="st">`</span><span class="dt">Deaths from Lung Diseases</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="../reference/ts_ts.html">ts_xts</a></span>(fdeaths),
  <span class="dt">title =</span> <span class="st">"Airlines, trappings, and deaths"</span>,
  <span class="dt">subtitle =</span> <span class="st">"Monthly passengers, annual trappings, monthly deaths"</span>
)</code></pre></div>
<div class="figure">
<img src="fig/plot1.png">
</div>
<p>There is also a version that uses <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> that uses the same syntax. With <code><a href="../reference/ts_ggplot.html">theme_tsbox()</a></code> and <code><a href="../reference/ts_ggplot.html">scale_color_tsbox()</a></code>, the output of <code>ts_ggplot</code> is very similar to <code>ts_plot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ts_ggplot</span>(<span class="kw"><a href="../reference/ts_scale.html">ts_scale</a></span>(<span class="kw"><a href="../reference/ts_c.html">ts_c</a></span>(mdeaths, austres, AirPassengers, <span class="dt">DAX =</span> EuStockMarkets[ ,<span class="st">'DAX'</span>])))</code></pre></div>
</div>
<div id="time-series-in-data-frames" class="section level2">
<h2 class="hasAnchor">
<a href="#time-series-in-data-frames" class="anchor"></a>Time series in data frames</h2>
<p>Thanks to packages such as <code>data.table</code> and <code>dplyr</code>, data frames have become the dominant data structure in R, and storing time series in a data frame is a natural consequence from this. And even if you donâ€™t intend to keep your time series in data frames, this is the format in which you import and export the data.</p>
<p>In data frames, i.e., in a <code>data.frame</code>, a <code>data.table</code>, or a <code>tibble</code>, tsbox stores one or multiple time series in the â€˜longâ€™ format. tsbox detects a <em>value</em>, a <em>time</em> and zero, one or several <em>id</em> columns. Column detection is done in the following order:</p>
<ol style="list-style-type: decimal">
<li><p>Starting <strong>on the right</strong>, the first first <code>numeric</code> or <code>integer</code> column is used as <strong>value column</strong>.</p></li>
<li><p>Using the remaining columns, and starting on the right again, the first <code>Date</code>, <code>POSIXct</code>, <code>numeric</code> or <code>character</code> column is used as <strong>time column</strong>. <code>character</code> strings are parsed by <code><a href="http://www.rdocumentation.org/packages/anytime/topics/anytime">anytime::anytime()</a></code>. The time stamp, <code>time</code>, indicates the beginning of a period.</p></li>
<li><p><strong>All remaining</strong> columns are <strong>id columns</strong>. Each unique combination of id columns points to a time series.</p></li>
</ol>
<p><strong>Alternatively</strong>, the time column and the value column to be <strong>explicitly named</strong> as <code>time</code> and <code>value</code>. If explicit names are used, the column order will be ignored. If column are detected automatically, a message is returned.</p>
</div>
<div id="using-tsbox-in-a-dplyr-pipe-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#using-tsbox-in-a-dplyr-pipe-workflow" class="anchor"></a>Using tsbox in a dplyr / pipe workflow</h2>
<p>tsbox works well with tibbles and with <code>%&gt;%</code>, so it can be nicely integrated into a dplyr workflow:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(nycflights13)
dta &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(origin, <span class="dt">time =</span> time_hour, temp, humid, precip) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ts_long</span>() 

dta <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(id <span class="op">==</span><span class="st"> "temp"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/ts_trend.html">ts_trend</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/ts_plot.html">ts_plot</a></span>()</code></pre></div>
</div>
<div id="using-tsbox-with-zoo-tibbletime-or-tsibble" class="section level2">
<h2 class="hasAnchor">
<a href="#using-tsbox-with-zoo-tibbletime-or-tsibble" class="anchor"></a>Using tsbox with zoo, tibbletime or tsibble</h2>
<p>A few other packages are dealing with time series</p>
<p>And it also can be used with <a href="https://cran.r-project.org/web/packages/tibbletime/index.html">tibbletime</a> and <a href="https://cran.r-project.org/web/packages/tsibble/index.html">tsibble</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#convert-everything-to-everything">Convert everything to everything</a></li>
      <li><a href="#use-same-functions-for-ts-xts-data-frame-data-table-or-tibble">Use same functions for ts, xts, data.frame, data.table or tibble</a></li>
      <li><a href="#combine-multiple-time-series">Combine multiple time series</a></li>
      <li><a href="#frequency-conversion-and-alignment">Frequency conversion and alignment</a></li>
      <li><a href="#and-plot-just-about-everything">And plot just about everything</a></li>
      <li><a href="#time-series-in-data-frames">Time series in data frames</a></li>
      <li><a href="#using-tsbox-in-a-dplyr-pipe-workflow">Using tsbox in a dplyr / pipe workflow</a></li>
      <li><a href="#using-tsbox-with-zoo-tibbletime-or-tsibble">Using tsbox with zoo, tibbletime or tsibble</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christoph Sax.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
